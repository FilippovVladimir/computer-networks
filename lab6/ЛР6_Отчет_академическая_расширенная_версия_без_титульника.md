
# ЛАБОРАТОРНАЯ РАБОТА №6  
## Трансляция сетевых адресов (NAT) в Cisco Packet Tracer

# ВВЕДЕНИЕ

Целью данной лабораторной работы является закрепление понимания принципов работы технологии NAT (Network Address Translation), а также формирование практических навыков настройки NAT и базовых механизмов фильтрации трафика в среде Cisco Packet Tracer.

В рамках работы необходимо:

- смоделировать подключение локальной сети к сети Интернет;
- проанализировать причину отсутствия связи без использования NAT;
- настроить динамический NAT с перегрузкой (PAT);
- проверить таблицу трансляций;
- реализовать статический NAT для публикации локального сервера в Интернет.

Технология NAT используется для преобразования внутренних (частных, «серых») IP‑адресов в публичные («белые») адреса, маршрутизируемые в сети Интернет. Это позволяет нескольким устройствам внутри локальной сети использовать один внешний IP‑адрес.

# 1. ДОБАВЛЕНИЕ ЭМУЛЯЦИИ СЕРВЕРА В СЕТИ ИНТЕРНЕТ

К ранее созданной схеме добавляется эмуляция сети Интернет. Вместо коммутатора третьего уровня используется маршрутизатор, который выполняет функции пограничного устройства.

На маршрутизаторе были созданы VLAN и соответствующие сабинтерфейсы:

Fa0/0.10  
Fa0/0.20  
Fa0/0.30  
Fa0/0.40  
Fa0/0.60  

Каждому сабинтерфейсу назначается IP‑адрес и указывается helper‑address для DHCP‑сервера.

![Рисунок 1.1 — Конфигурация роутера](fig1_1_router_config.png)  
*Описание: настройка сабинтерфейсов и helper‑address.*

Сервер в сети Интернет получает публичный адрес 210.230.20.2/30.  
Наш маршрутизатор получает адрес 210.230.10.2/30.  
Маршрутизатор провайдера имеет адрес 210.230.10.1.

Общая схема сети показана ниже.

![Рисунок 1.2 — Общая схема сети](fig1_2_network_scheme.png)

На нашем маршрутизаторе настраивается маршрут по умолчанию:

ip route 0.0.0.0 0.0.0.0 210.230.10.1

Это означает, что весь неизвестный трафик отправляется к провайдеру.

После этого маршрутизатор успешно пингует как маршрутизатор провайдера, так и сервер в Интернете.

![Рисунок 1.3 — Пинг до Интернета](fig1_3_router_ping.png)

Однако конечные устройства внутри локальной сети не могут получить доступ к Интернету.

![Рисунок 1.4 — Отсутствие доступа у ПК](fig1_4_pc_fail.png)

Причина заключается в том, что локальные адреса (например 10.10.0.0/24) не маршрутизируются в сети Интернет. Маршрутизатор провайдера не знает маршрутов к частным адресам RFC1918.

Путь пакета без NAT показан ниже.

![Рисунок 1.5 — Путь пакета без NAT](fig1_5_packet_path.png)

Запрос доходит до сервера, но ответный пакет не возвращается, так как внешний маршрутизатор не имеет маршрута к частной сети.

На маршрутизаторе провайдера фиксируется ошибка отсутствия маршрута.

![Рисунок 1.6 — Ошибка на роутере провайдера](fig1_6_provider_error.png)

# 2. НАСТРОЙКА ДИНАМИЧЕСКОГО NAT (PAT)

Для решения проблемы необходимо настроить трансляцию адресов.

Сначала определяется, какие интерфейсы являются внутренними (inside), а какие внешними (outside).

Интерфейс Fa0/1, обращённый к провайдеру:

interface Fa0/1  
ip nat outside

Сабинтерфейсы Fa0/0.x:

interface Fa0/0.10  
ip nat inside

![Рисунок 2.1 — Настройка inside/outside](fig2_1_nat_ports.png)

Далее создаётся список доступа, определяющий трафик для трансляции:

access-list 1 permit 10.10.0.0 0.0.0.255  
access-list 1 permit 10.60.0.0 0.0.0.255  

![Рисунок 2.2 — Access-list для NAT](fig2_2_acl.png)

Затем настраивается PAT (перегрузка):

ip nat inside source list 1 interface Fa0/1 overload

Ключевое слово overload означает, что несколько внутренних адресов будут использовать один внешний IP‑адрес с различными номерами портов.

После настройки NAT повторно выполняется ping с компьютера на сервер в Интернете.

![Рисунок 2.3 — Успешный ping](fig2_3_success_ping.png)

Связь установлена.

Таблицу трансляций можно просмотреть командой:

show ip nat translations

![Рисунок 2.4 — Таблица NAT](fig2_4_nat_table.png)

В таблице видно соответствие:

Inside local — внутренний адрес  
Inside global — внешний адрес  
Outside local — адрес назначения  
Outside global — публичный адрес назначения  

# 3. СТАТИЧЕСКИЙ NAT

Следующим этапом является обеспечение доступа из сети Интернет к локальному серверу.

В локальной сети сервер имеет адрес 10.60.0.2.  
Необходимо сделать его доступным по внешнему адресу 210.230.10.2.

Для этого используется команда:

ip nat inside source static tcp 10.60.0.2 80 210.230.10.2 80

Разбор команды:

- inside source — источник во внутренней сети  
- static — статическое сопоставление  
- tcp — протокол  
- 10.60.0.2 — внутренний адрес  
- 80 — порт веб‑сервера  
- 210.230.10.2 — внешний адрес  
- 80 — внешний порт  

После настройки пользователь из Интернета может открыть веб‑страницу локального сервера.

![Рисунок 3.1 — Открытая веб‑страница](fig3_1_web.png)

Таким образом, статический NAT позволяет публиковать внутренние ресурсы в Интернет.

# ЗАКЛЮЧЕНИЕ

В ходе выполнения лабораторной работы была смоделирована работа локальной сети с выходом в Интернет через маршрутизатор провайдера.

Было продемонстрировано, что без использования NAT частные IP‑адреса не маршрутизируются в глобальной сети.

Настроен динамический NAT с перегрузкой (PAT), обеспечивающий одновременный доступ множества внутренних устройств к Интернету через один публичный адрес.

Также был реализован статический NAT, позволяющий организовать доступ из внешней сети к внутреннему серверу.

Поставленные цели работы достигнуты: закреплено понимание принципов NAT и получены практические навыки его настройки в Cisco Packet Tracer.
